2025-06-10 08:20:39 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 08:20:39 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 08:20:39 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 08:20:39 [OrderManagerTest] INFO: Server time: 2025-06-10 08:20:39
2025-06-10 08:20:39 [OrderManagerTest] INFO: Local time: 2025-06-10 08:20:39
2025-06-10 08:20:39 [OrderManagerTest] INFO: Time difference: -0.48 seconds
2025-06-10 08:20:39 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 08:21:00
2025-06-10 08:20:39 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 08:25:00
2025-06-10 08:20:39 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 09:00:00
2025-06-10 08:20:39 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 08:20:39 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 08:20:41 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 08:20:41 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 08:20:41 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 08:20:43 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 08:20:43 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 08:20:43 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 08:20:43 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 08:20:43 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 08:20:44 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 08:20:44 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 08:20:44 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 08:20:44 [OrderManagerTest] INFO: Initializing OrderManager for BTCUSDT
2025-06-10 08:20:44 [OrderManagerTest] INFO: Instrument precision - Price: 1 decimals, Quantity: 3 decimals
2025-06-10 08:20:45 [OrderManagerTest] INFO: No active positions
2025-06-10 08:20:45 [OrderManagerTest] INFO: No active orders
2025-06-10 08:20:45 [OrderManagerTest] INFO: OrderManager initialization completed
2025-06-10 08:20:45 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 08:20:45 [OrderManagerTest] INFO: ============================================================
2025-06-10 08:20:45 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 08:20:45 [OrderManagerTest] INFO: Test Date: 2025-06-09 22:20:45 UTC
2025-06-10 08:20:45 [OrderManagerTest] INFO: ============================================================
2025-06-10 08:20:45 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:45 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 08:20:45 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:45 [OrderManagerTest] ERROR: Position status test failed: 'OrderManager' object has no attribute 'get_positions'
2025-06-10 08:20:45 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:45 [OrderManagerTest] INFO: Ticker: Last: 111500.0 - 24h Change: -0.021929%
2025-06-10 08:20:47 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:47 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 08:20:47 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:47 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 08:20:47 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:49 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:49 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 08:20:49 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:49 [OrderManagerTest] ERROR: Market buy test failed: 'OrderManager' object has no attribute 'calculate_position_size'
2025-06-10 08:20:49 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:51 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:51 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 08:20:51 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:51 [OrderManagerTest] ERROR: Market sell test failed: 'OrderManager' object has no attribute 'calculate_position_size'
2025-06-10 08:20:51 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:53 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:53 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 08:20:53 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:53 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 08:20:53 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:55 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:55 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 08:20:55 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:55 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 08:20:55 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:57 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:57 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 08:20:57 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:57 [OrderManagerTest] ERROR: Take profit test failed: 'OrderManager' object has no attribute 'calculate_position_size'
2025-06-10 08:20:57 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:20:59 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:20:59 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 08:20:59 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:20:59 [OrderManagerTest] ERROR: Stop loss test failed: 'OrderManager' object has no attribute 'get_positions'
2025-06-10 08:20:59 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:21:00 [OrderManagerTest] INFO: Updated 1m candle from REST API: O: 111500.0 H: 111500.0 L: 111500.0 C: 111500.0 V: 0.0
2025-06-10 08:21:00 [OrderManagerTest] INFO: New 1m candle closed: 2025-06-09 22:21:00 - O: 111500.0 H: 111500.0 L: 111500.0 C: 111500.0 V: 0.0
2025-06-10 08:21:01 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:21:01 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 08:21:01 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:21:01 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 08:21:01 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:21:03 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:21:03 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 08:21:03 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:21:03 [OrderManagerTest] ERROR: Close position test failed: 'OrderManager' object has no attribute 'calculate_position_size'
2025-06-10 08:21:03 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:21:05 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:21:05 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 08:21:05 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:21:05 [OrderManagerTest] ERROR: Risk management test failed: 'OrderManager' object has no attribute 'get_account_balance'
2025-06-10 08:21:05 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:21:07 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:21:07 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 08:21:07 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:21:07 [OrderManagerTest] ERROR: Order tracking test failed: 'OrderManager' object has no attribute 'calculate_position_size'
2025-06-10 08:21:07 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 08:21:09 [OrderManagerTest] INFO: 
==================================================
2025-06-10 08:21:09 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 08:21:09 [OrderManagerTest] INFO: ==================================================
2025-06-10 08:21:09 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 08:21:09 [OrderManagerTest] INFO: Invalid symbol error handled: place_market_order() got an unexpected keyword argument 'qty'
2025-06-10 08:21:09 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 08:21:09 [OrderManagerTest] INFO: Invalid quantity error handled: place_market_order() got an unexpected keyword argument 'qty'
2025-06-10 08:21:09 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 08:21:09 [OrderManagerTest] INFO: Invalid order ID error handled: get_order_status() got an unexpected keyword argument 'symbol'
2025-06-10 08:21:09 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 08:21:11 [OrderManagerTest] INFO: 
============================================================
2025-06-10 08:21:11 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 08:21:11 [OrderManagerTest] INFO: ============================================================
2025-06-10 08:21:11 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 08:21:11 [OrderManagerTest] INFO: Passed: 1 ✅
2025-06-10 08:21:11 [OrderManagerTest] INFO: Failed: 12 ❌
2025-06-10 08:21:11 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 08:21:11 [OrderManagerTest] INFO: Success Rate: 7.7%
2025-06-10 08:21:11 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 08:21:11 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Position Status: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Market Buy Order: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Market Sell Order: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Risk Management: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ❌ Order Tracking: FAIL
2025-06-10 08:21:11 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 08:21:11 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_082111.json
2025-06-10 08:21:11 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 08:21:11 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 08:21:11 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 08:21:11 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 08:21:11 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 08:21:11 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 08:21:11 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 08:21:11 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 08:21:11 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 08:21:11 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 08:21:12 [OrderManagerTest] INFO: DataManager closed
2025-06-10 08:21:12 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 08:21:12 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 10:39:20 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 10:39:20 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 10:39:20 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 10:39:21 [OrderManagerTest] INFO: Server time: 2025-06-10 10:39:21
2025-06-10 10:39:21 [OrderManagerTest] INFO: Local time: 2025-06-10 10:39:21
2025-06-10 10:39:21 [OrderManagerTest] INFO: Time difference: -0.23 seconds
2025-06-10 10:39:21 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 10:40:00
2025-06-10 10:39:21 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 10:40:00
2025-06-10 10:39:21 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 11:00:00
2025-06-10 10:39:21 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 10:39:21 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 10:39:23 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 10:39:23 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 10:39:23 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 10:39:24 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 10:39:24 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 10:39:24 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 10:39:25 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 10:39:25 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 10:39:25 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 10:39:25 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 10:39:25 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 10:39:25 [OrderManagerTest] ERROR: Initialization failed: 'APICredentials' object has no attribute 'get'
2025-06-10 10:39:25 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 10:39:25 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 10:39:25 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 10:39:25 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 10:39:26 [OrderManagerTest] INFO: DataManager closed
2025-06-10 10:39:26 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 10:39:26 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 10:41:31 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 10:41:31 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 10:41:31 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 10:41:32 [OrderManagerTest] INFO: Server time: 2025-06-10 10:41:32
2025-06-10 10:41:32 [OrderManagerTest] INFO: Local time: 2025-06-10 10:41:31
2025-06-10 10:41:32 [OrderManagerTest] INFO: Time difference: 0.03 seconds
2025-06-10 10:41:32 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 10:42:00
2025-06-10 10:41:32 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 10:45:00
2025-06-10 10:41:32 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 11:00:00
2025-06-10 10:41:32 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 10:41:32 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 10:41:34 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 10:41:34 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 10:41:34 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 10:41:35 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 10:41:35 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 10:41:35 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 10:41:36 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 10:41:36 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 10:41:37 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 10:41:37 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 10:41:37 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 10:41:37 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 10:41:37 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 10:41:37 [OrderManagerTest] ERROR: Instrument info not found for BTCUSDT
2025-06-10 10:41:37 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 10:41:37 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 10:41:37 [OrderManagerTest] INFO: ============================================================
2025-06-10 10:41:37 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 10:41:37 [OrderManagerTest] INFO: Test Date: 2025-06-10 00:41:37 UTC
2025-06-10 10:41:37 [OrderManagerTest] INFO: ============================================================
2025-06-10 10:41:37 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:37 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 10:41:37 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:37 [OrderManagerTest] INFO: Current positions: []
2025-06-10 10:41:37 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 10:41:37 [OrderManagerTest] INFO: Ticker: Last: 110000.0 - 24h Change: -0.098197%
2025-06-10 10:41:39 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:39 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 10:41:39 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:39 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:41:39 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:41 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:41 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 10:41:41 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:41 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6DE40> BTCUSDT (approx $5)
2025-06-10 10:41:41 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:41:41 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:41:41 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:43 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:43 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 10:41:43 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:43 [OrderManagerTest] INFO: Placing market sell order: <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6D540> BTCUSDT (approx $5)
2025-06-10 10:41:43 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:41:43 [OrderManagerTest] ERROR: Failed to place market sell order
2025-06-10 10:41:43 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:45 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:45 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 10:41:45 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:45 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:41:45 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:47 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:47 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 10:41:47 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:47 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:41:47 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:49 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:49 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 10:41:49 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:49 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6DE40> BTCUSDT
2025-06-10 10:41:49 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:41:49 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:41:49 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:50 [OrderManagerTest] INFO: Ticker: Last: 110156.9 - 24h Change: -0.09691%
2025-06-10 10:41:51 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:51 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 10:41:51 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:52 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6D540> BTCUSDT
2025-06-10 10:41:52 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:41:52 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:41:52 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:54 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:54 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 10:41:54 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:54 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:41:54 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:56 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:56 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 10:41:56 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:56 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6DE40> BTCUSDT
2025-06-10 10:41:56 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:41:56 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:41:56 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:41:58 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:41:58 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 10:41:58 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:41:58 [OrderManagerTest] INFO: Account balance: 0.0 USDT
2025-06-10 10:41:58 [OrderManagerTest] INFO: Risk 1.0%: 0.0 USDT = <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6D9C0> contracts
2025-06-10 10:41:58 [OrderManagerTest] INFO: Risk 2.0%: 0.0 USDT = <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6D840> contracts
2025-06-10 10:41:58 [OrderManagerTest] INFO: Risk 5.0%: 0.0 USDT = <coroutine object OrderManager.calculate_position_size at 0x000001BA65D6D540> contracts
2025-06-10 10:41:58 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 10:42:00 [OrderManagerTest] INFO: Updated 1m candle from REST API: O: 110156.9 H: 110156.9 L: 110156.9 C: 110156.9 V: 0.0
2025-06-10 10:42:00 [OrderManagerTest] INFO: New 1m candle closed: 2025-06-10 00:42:00 - O: 110156.9 H: 110156.9 L: 110156.9 C: 110156.9 V: 0.0
2025-06-10 10:42:00 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:42:00 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 10:42:00 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:42:00 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001BA65CCA240> BTCUSDT
2025-06-10 10:42:00 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:42:00 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:42:00 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:42:02 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:42:02 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 10:42:02 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:42:02 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 10:42:02 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 00:42:02).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 10:42:02 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 00:42:02).\nRequest → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.'}
2025-06-10 10:42:02 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 10:42:02 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 10:42:02 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 10:42:02 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 10:42:04 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 10:42:04 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 10:42:04 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 10:42:06 [OrderManagerTest] INFO: 
============================================================
2025-06-10 10:42:06 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 10:42:06 [OrderManagerTest] INFO: ============================================================
2025-06-10 10:42:06 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 10:42:06 [OrderManagerTest] INFO: Passed: 3 ✅
2025-06-10 10:42:06 [OrderManagerTest] INFO: Failed: 10 ❌
2025-06-10 10:42:06 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 10:42:06 [OrderManagerTest] INFO: Success Rate: 23.1%
2025-06-10 10:42:06 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 10:42:06 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 10:42:06 [OrderManagerTest] INFO: ✅ Position Status: PASS
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Market Buy Order: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Market Sell Order: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ✅ Risk Management: PASS
2025-06-10 10:42:06 [OrderManagerTest] INFO: ❌ Order Tracking: FAIL
2025-06-10 10:42:06 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 10:42:06 [OrderManagerTest] ERROR: Failed to save report: Object of type coroutine is not JSON serializable
2025-06-10 10:42:06 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 10:42:06 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 10:42:06 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 10:42:06 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 10:42:06 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 10:42:06 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 10:42:06 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 10:42:06 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 10:42:06 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 10:42:06 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 10:42:06 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 10:42:06 [OrderManagerTest] INFO: DataManager closed
2025-06-10 10:42:06 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 10:42:06 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 10:52:47 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 10:52:47 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 10:52:47 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 10:52:47 [OrderManagerTest] INFO: Server time: 2025-06-10 10:52:47
2025-06-10 10:52:47 [OrderManagerTest] INFO: Local time: 2025-06-10 10:52:47
2025-06-10 10:52:47 [OrderManagerTest] INFO: Time difference: -0.33 seconds
2025-06-10 10:52:47 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 10:53:00
2025-06-10 10:52:47 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 10:55:00
2025-06-10 10:52:47 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 11:00:00
2025-06-10 10:52:47 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 10:52:47 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 10:52:49 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 10:52:49 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 10:52:49 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 10:52:50 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 10:52:50 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 10:52:50 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 10:52:51 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 10:52:51 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 10:52:51 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 10:52:51 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 10:52:51 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 10:52:51 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 10:52:51 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 10:52:52 [OrderManagerTest] ERROR: Instrument info not found for BTCUSDT
2025-06-10 10:52:52 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 10:52:52 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 10:52:52 [OrderManagerTest] INFO: ============================================================
2025-06-10 10:52:52 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 10:52:52 [OrderManagerTest] INFO: Test Date: 2025-06-10 00:52:52 UTC
2025-06-10 10:52:52 [OrderManagerTest] INFO: ============================================================
2025-06-10 10:52:52 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:52:52 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 10:52:52 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:52:52 [OrderManagerTest] INFO: Current positions: []
2025-06-10 10:52:52 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 10:52:52 [OrderManagerTest] INFO: Ticker: Last: 122072.3 - 24h Change: 0.014814%
2025-06-10 10:52:54 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:52:54 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 10:52:54 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:52:54 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:52:54 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:52:56 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:52:56 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 10:52:56 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:52:56 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D86A23E140> BTCUSDT (approx $5)
2025-06-10 10:52:56 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:52:56 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:52:56 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:52:58 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:52:58 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 10:52:58 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:52:58 [OrderManagerTest] INFO: Placing market sell order: <coroutine object OrderManager.calculate_position_size at 0x000001D86A23E040> BTCUSDT (approx $5)
2025-06-10 10:52:58 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:52:58 [OrderManagerTest] ERROR: Failed to place market sell order
2025-06-10 10:52:58 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:00 [OrderManagerTest] INFO: Updated 1m candle from REST API: O: 122072.3 H: 122072.3 L: 122072.3 C: 122072.3 V: 0.0
2025-06-10 10:53:00 [OrderManagerTest] INFO: New 1m candle closed: 2025-06-10 00:53:00 - O: 122072.3 H: 122072.3 L: 122072.3 C: 122072.3 V: 0.0
2025-06-10 10:53:00 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:00 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 10:53:00 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:00 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:53:00 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:02 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:02 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 10:53:02 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:02 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:53:02 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:04 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:04 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 10:53:04 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:04 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D86A29A8C0> BTCUSDT
2025-06-10 10:53:04 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:53:04 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:53:04 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:06 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:06 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 10:53:06 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:07 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D86A1F92C0> BTCUSDT
2025-06-10 10:53:07 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:53:07 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:53:07 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:09 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:09 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 10:53:09 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:09 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 10:53:09 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:11 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:11 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 10:53:11 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:11 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D86A29ACC0> BTCUSDT
2025-06-10 10:53:11 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:53:11 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:53:11 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:13 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:13 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 10:53:13 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:13 [OrderManagerTest] INFO: Account balance: 0.0 USDT
2025-06-10 10:53:13 [OrderManagerTest] INFO: Risk 1.0%: 0.0 USDT = <coroutine object OrderManager.calculate_position_size at 0x000001D86A29A8C0> contracts
2025-06-10 10:53:13 [OrderManagerTest] INFO: Risk 2.0%: 0.0 USDT = <coroutine object OrderManager.calculate_position_size at 0x000001D86A29AE40> contracts
2025-06-10 10:53:13 [OrderManagerTest] INFO: Risk 5.0%: 0.0 USDT = <coroutine object OrderManager.calculate_position_size at 0x000001D86A29A740> contracts
2025-06-10 10:53:13 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 10:53:15 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:15 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 10:53:15 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:15 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D86A29A5C0> BTCUSDT
2025-06-10 10:53:15 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 10:53:15 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 10:53:15 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 10:53:16 [OrderManagerTest] INFO: Ticker: Last: 121925.9 - 24h Change: 0.013597%
2025-06-10 10:53:17 [OrderManagerTest] INFO: 
==================================================
2025-06-10 10:53:17 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 10:53:17 [OrderManagerTest] INFO: ==================================================
2025-06-10 10:53:17 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 10:53:17 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 00:53:17).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 10:53:17 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 00:53:17).\nRequest → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.'}
2025-06-10 10:53:17 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 10:53:17 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 10:53:17 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 10:53:17 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 10:53:18 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 10:53:18 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 10:53:18 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 10:53:20 [OrderManagerTest] INFO: 
============================================================
2025-06-10 10:53:20 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 10:53:20 [OrderManagerTest] INFO: ============================================================
2025-06-10 10:53:20 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 10:53:20 [OrderManagerTest] INFO: Passed: 3 ✅
2025-06-10 10:53:20 [OrderManagerTest] INFO: Failed: 10 ❌
2025-06-10 10:53:20 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 10:53:20 [OrderManagerTest] INFO: Success Rate: 23.1%
2025-06-10 10:53:20 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 10:53:20 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 10:53:20 [OrderManagerTest] INFO: ✅ Position Status: PASS
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Market Buy Order: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Market Sell Order: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ✅ Risk Management: PASS
2025-06-10 10:53:20 [OrderManagerTest] INFO: ❌ Order Tracking: FAIL
2025-06-10 10:53:20 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 10:53:20 [OrderManagerTest] ERROR: Failed to save report: Object of type coroutine is not JSON serializable
2025-06-10 10:53:20 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 10:53:20 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 10:53:20 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 10:53:20 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 10:53:20 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 10:53:20 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 10:53:20 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 10:53:20 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 10:53:20 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 10:53:20 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 10:53:20 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 10:53:20 [OrderManagerTest] INFO: DataManager closed
2025-06-10 10:53:20 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 10:53:20 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 10:54:38 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 10:54:38 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 10:54:38 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 10:54:38 [OrderManagerTest] INFO: Server time: 2025-06-10 10:54:38
2025-06-10 10:54:38 [OrderManagerTest] INFO: Local time: 2025-06-10 10:54:38
2025-06-10 10:54:38 [OrderManagerTest] INFO: Time difference: -0.70 seconds
2025-06-10 10:54:38 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 10:55:00
2025-06-10 10:54:38 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 10:55:00
2025-06-10 10:54:38 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 11:00:00
2025-06-10 10:54:38 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 10:54:38 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 10:54:40 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 10:54:40 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 10:54:40 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 10:54:41 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 10:54:41 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 10:54:41 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 10:54:41 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 10:54:41 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 10:54:42 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 10:54:42 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 10:54:42 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 10:54:42 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 10:54:42 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 10:54:42 [OrderManagerTest] ERROR: Instrument info not found for BTCUSDT
2025-06-10 10:54:42 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 10:54:42 [OrderManagerTest] ERROR: Initialization failed: object bool can't be used in 'await' expression
2025-06-10 10:54:42 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 10:54:42 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 10:54:42 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 10:54:42 [OrderManagerTest] ERROR: Error closing OrderManager: object bool can't be used in 'await' expression
2025-06-10 10:54:42 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 10:54:42 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 10:54:42 [OrderManagerTest] INFO: Ticker: Last: 119547.2 - 24h Change: -0.004597%
2025-06-10 10:54:42 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 10:54:42 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 10:54:42 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 10:54:43 [OrderManagerTest] INFO: DataManager closed
2025-06-10 10:54:43 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 10:54:43 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 11:00:23 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 11:00:23 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 11:00:23 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 11:00:24 [OrderManagerTest] INFO: Server time: 2025-06-10 11:00:24
2025-06-10 11:00:24 [OrderManagerTest] INFO: Local time: 2025-06-10 11:00:23
2025-06-10 11:00:24 [OrderManagerTest] INFO: Time difference: 0.08 seconds
2025-06-10 11:00:24 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 11:01:00
2025-06-10 11:00:24 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 11:05:00
2025-06-10 11:00:24 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 12:00:00
2025-06-10 11:00:24 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 11:00:24 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 11:00:26 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 11:00:26 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 11:00:26 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 11:00:27 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 11:00:27 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 11:00:27 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 11:00:28 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 11:00:28 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 11:00:29 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 11:00:29 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 11:00:29 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 11:00:29 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 11:00:29 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 11:00:29 [OrderManagerTest] ERROR: Instrument info not found for BTCUSDT
2025-06-10 11:00:29 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 11:00:29 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 11:00:29 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:00:29 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 11:00:29 [OrderManagerTest] INFO: Test Date: 2025-06-10 01:00:29 UTC
2025-06-10 11:00:29 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:00:29 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:29 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 11:00:29 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:29 [OrderManagerTest] ERROR: Position status test failed: object list can't be used in 'await' expression
2025-06-10 11:00:29 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:29 [OrderManagerTest] INFO: Ticker: Last: 123500.0 - 24h Change: 0.044079%
2025-06-10 11:00:31 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:31 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 11:00:31 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:31 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:00:31 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:32 [OrderManagerTest] INFO: Ticker: Last: 123449.5 - 24h Change: 0.072969%
2025-06-10 11:00:33 [OrderManagerTest] INFO: Ticker: Last: 123370.0 - 24h Change: 0.072278%
2025-06-10 11:00:33 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:33 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 11:00:33 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:33 [OrderManagerTest] ERROR: Ticker not found for BTCUSDT
2025-06-10 11:00:33 [OrderManagerTest] ERROR: Invalid price for BTCUSDT: 0.0
2025-06-10 11:00:33 [OrderManagerTest] INFO: Placing market buy order: 0 BTCUSDT (approx $5)
2025-06-10 11:00:33 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:00:33 [OrderManagerTest] ERROR: Market buy test failed: object dict can't be used in 'await' expression
2025-06-10 11:00:33 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:33 [OrderManagerTest] INFO: Ticker: Last: 123289.2 - 24h Change: 0.071575%
2025-06-10 11:00:35 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:35 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 11:00:35 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:36 [OrderManagerTest] ERROR: Ticker not found for BTCUSDT
2025-06-10 11:00:36 [OrderManagerTest] ERROR: Invalid price for BTCUSDT: 0.0
2025-06-10 11:00:36 [OrderManagerTest] INFO: Placing market sell order: 0 BTCUSDT (approx $5)
2025-06-10 11:00:36 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:00:36 [OrderManagerTest] ERROR: Market sell test failed: object dict can't be used in 'await' expression
2025-06-10 11:00:36 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:38 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:38 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 11:00:38 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:38 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:00:38 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:38 [OrderManagerTest] INFO: Ticker: Last: 123501.0 - 24h Change: 0.073416%
2025-06-10 11:00:38 [OrderManagerTest] INFO: Ticker: Last: 123603.2 - 24h Change: 0.074305%
2025-06-10 11:00:38 [OrderManagerTest] INFO: Ticker: Last: 123626.1 - 24h Change: 0.074504%
2025-06-10 11:00:38 [OrderManagerTest] INFO: Ticker: Last: 123581.5 - 24h Change: 0.074116%
2025-06-10 11:00:40 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:40 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 11:00:40 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:40 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:00:40 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:42 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:42 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 11:00:42 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:42 [OrderManagerTest] ERROR: Ticker not found for BTCUSDT
2025-06-10 11:00:42 [OrderManagerTest] ERROR: Invalid price for BTCUSDT: 0.0
2025-06-10 11:00:42 [OrderManagerTest] INFO: Placing market buy order: 0 BTCUSDT
2025-06-10 11:00:42 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:00:42 [OrderManagerTest] ERROR: Take profit test failed: object dict can't be used in 'await' expression
2025-06-10 11:00:42 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:43 [OrderManagerTest] INFO: Ticker: Last: 123504.8 - 24h Change: 0.073449%
2025-06-10 11:00:43 [OrderManagerTest] INFO: Ticker: Last: 123606.5 - 24h Change: 0.074333%
2025-06-10 11:00:44 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:44 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 11:00:44 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:44 [OrderManagerTest] ERROR: Stop loss test failed: object list can't be used in 'await' expression
2025-06-10 11:00:44 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:46 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:46 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 11:00:46 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:46 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:00:46 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:48 [OrderManagerTest] INFO: Ticker: Last: 123627.3 - 24h Change: 0.074514%
2025-06-10 11:00:48 [OrderManagerTest] INFO: Ticker: Last: 123552.0 - 24h Change: 0.07386%
2025-06-10 11:00:48 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:48 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 11:00:48 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:49 [OrderManagerTest] ERROR: Ticker not found for BTCUSDT
2025-06-10 11:00:49 [OrderManagerTest] ERROR: Invalid price for BTCUSDT: 0.0
2025-06-10 11:00:49 [OrderManagerTest] INFO: Placing market buy order: 0 BTCUSDT
2025-06-10 11:00:49 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:00:49 [OrderManagerTest] ERROR: Close position test failed: object dict can't be used in 'await' expression
2025-06-10 11:00:49 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:49 [OrderManagerTest] INFO: Ticker: Last: 123525.6 - 24h Change: 0.07363%
2025-06-10 11:00:49 [OrderManagerTest] INFO: Ticker: Last: 123530.0 - 24h Change: 0.073668%
2025-06-10 11:00:51 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:51 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 11:00:51 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:51 [OrderManagerTest] ERROR: Risk management test failed: object dict can't be used in 'await' expression
2025-06-10 11:00:51 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:53 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:53 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 11:00:53 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:53 [OrderManagerTest] ERROR: Ticker not found for BTCUSDT
2025-06-10 11:00:53 [OrderManagerTest] ERROR: Invalid price for BTCUSDT: 0.0
2025-06-10 11:00:53 [OrderManagerTest] INFO: Placing market buy order: 0 BTCUSDT
2025-06-10 11:00:53 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:00:53 [OrderManagerTest] ERROR: Order tracking test failed: object dict can't be used in 'await' expression
2025-06-10 11:00:53 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:00:53 [OrderManagerTest] INFO: Ticker: Last: 123263.6 - 24h Change: 0.071353%
2025-06-10 11:00:54 [OrderManagerTest] INFO: Ticker: Last: 123250.1 - 24h Change: 0.071236%
2025-06-10 11:00:55 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:00:55 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 11:00:55 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:00:55 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 11:00:56 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:00:56).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 11:00:56 [OrderManagerTest] INFO: Invalid symbol error handled: object dict can't be used in 'await' expression
2025-06-10 11:00:56 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 11:00:56 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:00:56 [OrderManagerTest] INFO: Invalid quantity error handled: object dict can't be used in 'await' expression
2025-06-10 11:00:56 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 11:00:56 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 11:00:56 [OrderManagerTest] INFO: Invalid order ID error handled: object str can't be used in 'await' expression
2025-06-10 11:00:56 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:00:58 [OrderManagerTest] INFO: 
============================================================
2025-06-10 11:00:58 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 11:00:58 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:00:58 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 11:00:58 [OrderManagerTest] INFO: Passed: 1 ✅
2025-06-10 11:00:58 [OrderManagerTest] INFO: Failed: 12 ❌
2025-06-10 11:00:58 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 11:00:58 [OrderManagerTest] INFO: Success Rate: 7.7%
2025-06-10 11:00:58 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 11:00:58 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Position Status: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Market Buy Order: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Market Sell Order: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Risk Management: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ❌ Order Tracking: FAIL
2025-06-10 11:00:58 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 11:00:58 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_110058.json
2025-06-10 11:00:58 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 11:00:58 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 11:00:58 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 11:00:58 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 11:00:58 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 11:00:58 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 11:00:58 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 11:00:58 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 11:00:58 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 11:00:58 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 11:00:58 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 11:00:59 [OrderManagerTest] INFO: DataManager closed
2025-06-10 11:00:59 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 11:00:59 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 11:09:53 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 11:09:53 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 11:09:53 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 11:09:54 [OrderManagerTest] INFO: Server time: 2025-06-10 11:09:54
2025-06-10 11:09:54 [OrderManagerTest] INFO: Local time: 2025-06-10 11:09:53
2025-06-10 11:09:54 [OrderManagerTest] INFO: Time difference: 0.16 seconds
2025-06-10 11:09:54 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 11:10:00
2025-06-10 11:09:54 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 11:10:00
2025-06-10 11:09:54 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 12:00:00
2025-06-10 11:09:54 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 11:09:54 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 11:09:56 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 11:09:56 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 11:09:56 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 11:09:57 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 11:09:57 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 11:09:57 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 11:09:58 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 11:09:58 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 11:09:58 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 11:09:58 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 11:09:58 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 11:09:58 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 11:09:58 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 11:09:59 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 11:09:59 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 11:09:59 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:09:59 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 11:09:59 [OrderManagerTest] INFO: Test Date: 2025-06-10 01:09:59 UTC
2025-06-10 11:09:59 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:09:59 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:09:59 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 11:09:59 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:09:59 [OrderManagerTest] ERROR: Position status test failed: object list can't be used in 'await' expression
2025-06-10 11:09:59 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:09:59 [OrderManagerTest] INFO: Ticker: Last: 123948.9 - 24h Change: 0.054884%
2025-06-10 11:09:59 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.05531%
2025-06-10 11:10:00 [OrderManagerTest] INFO: Updated 1m candle from REST API: O: 123999.0 H: 123999.0 L: 123999.0 C: 123999.0 V: 0.0
2025-06-10 11:10:00 [OrderManagerTest] INFO: New 1m candle closed: 2025-06-10 01:10:00 - O: 123999.0 H: 123999.0 L: 123999.0 C: 123999.0 V: 0.0
2025-06-10 11:10:00 [OrderManagerTest] INFO: Updated 5m candle from REST API: O: 123999.0 H: 123999.0 L: 123999.0 C: 123999.0 V: 0.0
2025-06-10 11:10:00 [OrderManagerTest] INFO: New 5m candle closed: 2025-06-10 01:10:00 - O: 123999.0 H: 123999.0 L: 123999.0 C: 123999.0 V: 0.0
2025-06-10 11:10:00 [OrderManagerTest] INFO: Ticker: Last: 123713.5 - 24h Change: 0.05288%
2025-06-10 11:10:01 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:01 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 11:10:01 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:01 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:10:01 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:03 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:03 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 11:10:03 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:03 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123713.5: 0.001
2025-06-10 11:10:03 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT (approx $5)
2025-06-10 11:10:03 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: e3483996-72c2-426b-aa6f-8f6a9adf12ca
2025-06-10 11:10:03 [OrderManagerTest] ERROR: Market buy test failed: object dict can't be used in 'await' expression
2025-06-10 11:10:03 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:03 [OrderManagerTest] INFO: Ticker: Last: 123430.2 - 24h Change: 0.050469%
2025-06-10 11:10:03 [OrderManagerTest] INFO: Ticker: Last: 123757.0 - 24h Change: 0.053251%
2025-06-10 11:10:04 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.05531%
2025-06-10 11:10:04 [OrderManagerTest] INFO: Ticker: Last: 123787.9 - 24h Change: 0.053514%
2025-06-10 11:10:04 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.05531%
2025-06-10 11:10:05 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:05 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 11:10:05 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:06 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123999.0: 0.001
2025-06-10 11:10:06 [OrderManagerTest] INFO: Placing market sell order: 0.001 BTCUSDT (approx $5)
2025-06-10 11:10:06 [OrderManagerTest] INFO: Market Sell order placed for 0.001 BTCUSDT: 900241e9-389b-449c-a3e5-4b0a2af2ec91
2025-06-10 11:10:06 [OrderManagerTest] ERROR: Market sell test failed: object dict can't be used in 'await' expression
2025-06-10 11:10:06 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:06 [OrderManagerTest] INFO: Ticker: Last: 123787.9 - 24h Change: 0.053514%
2025-06-10 11:10:08 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:08 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 11:10:08 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:08 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:10:08 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:09 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.05531%
2025-06-10 11:10:10 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:10 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 11:10:10 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:10 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:10:10 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:12 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:12 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 11:10:12 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:12 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123999.0: 0.001
2025-06-10 11:10:12 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:10:12 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 2d9768c2-e64e-4507-b337-fe4a6ea89ac7
2025-06-10 11:10:12 [OrderManagerTest] ERROR: Take profit test failed: object dict can't be used in 'await' expression
2025-06-10 11:10:12 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:13 [OrderManagerTest] INFO: Ticker: Last: 123966.1 - 24h Change: 0.05503%
2025-06-10 11:10:14 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.045741%
2025-06-10 11:10:14 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:14 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 11:10:14 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:15 [OrderManagerTest] ERROR: Stop loss test failed: object list can't be used in 'await' expression
2025-06-10 11:10:15 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:17 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:17 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 11:10:17 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:17 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:10:17 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:19 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:19 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 11:10:19 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:19 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123999.0: 0.001
2025-06-10 11:10:19 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:10:19 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 16e6f4af-039e-4676-9913-723a5407e4c4
2025-06-10 11:10:19 [OrderManagerTest] ERROR: Close position test failed: object dict can't be used in 'await' expression
2025-06-10 11:10:19 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:19 [OrderManagerTest] INFO: Ticker: Last: 123980.2 - 24h Change: 0.045582%
2025-06-10 11:10:20 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.045741%
2025-06-10 11:10:21 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:21 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 11:10:21 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:22 [OrderManagerTest] ERROR: Risk management test failed: object dict can't be used in 'await' expression
2025-06-10 11:10:22 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:24 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:24 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 11:10:24 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:24 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123999.0: 0.001
2025-06-10 11:10:24 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:10:24 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 6e38e6b9-407f-4866-bf36-b65ecc6137ac
2025-06-10 11:10:24 [OrderManagerTest] ERROR: Order tracking test failed: object dict can't be used in 'await' expression
2025-06-10 11:10:24 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:10:24 [OrderManagerTest] INFO: Ticker: Last: 123980.2 - 24h Change: 0.045582%
2025-06-10 11:10:25 [OrderManagerTest] INFO: Ticker: Last: 123999.0 - 24h Change: 0.045741%
2025-06-10 11:10:26 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:10:26 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 11:10:26 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:10:26 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 11:10:26 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:10:26).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 11:10:26 [OrderManagerTest] INFO: Invalid symbol error handled: object dict can't be used in 'await' expression
2025-06-10 11:10:26 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 11:10:26 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:10:26 [OrderManagerTest] INFO: Invalid quantity error handled: object dict can't be used in 'await' expression
2025-06-10 11:10:26 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 11:10:27 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 11:10:27 [OrderManagerTest] INFO: Invalid order ID error handled: object str can't be used in 'await' expression
2025-06-10 11:10:27 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:10:27 [OrderManagerTest] INFO: Ticker: Last: 123726.0 - 24h Change: 0.043439%
2025-06-10 11:10:29 [OrderManagerTest] INFO: 
============================================================
2025-06-10 11:10:29 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 11:10:29 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:10:29 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 11:10:29 [OrderManagerTest] INFO: Passed: 1 ✅
2025-06-10 11:10:29 [OrderManagerTest] INFO: Failed: 12 ❌
2025-06-10 11:10:29 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 11:10:29 [OrderManagerTest] INFO: Success Rate: 7.7%
2025-06-10 11:10:29 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 11:10:29 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Position Status: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Market Buy Order: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Market Sell Order: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Risk Management: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ❌ Order Tracking: FAIL
2025-06-10 11:10:29 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 11:10:29 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_111029.json
2025-06-10 11:10:29 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 11:10:29 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 11:10:29 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 11:10:29 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 11:10:29 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 11:10:29 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 11:10:29 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 11:10:29 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 11:10:29 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 11:10:29 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 11:10:29 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 11:10:30 [OrderManagerTest] INFO: DataManager closed
2025-06-10 11:10:30 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 11:10:30 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 11:18:11 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 11:18:11 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 11:18:11 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 11:18:12 [OrderManagerTest] INFO: Server time: 2025-06-10 11:18:11
2025-06-10 11:18:12 [OrderManagerTest] INFO: Local time: 2025-06-10 11:18:11
2025-06-10 11:18:12 [OrderManagerTest] INFO: Time difference: -0.94 seconds
2025-06-10 11:18:12 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 11:19:00
2025-06-10 11:18:12 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 11:20:00
2025-06-10 11:18:12 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 12:00:00
2025-06-10 11:18:12 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 11:18:12 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 11:18:14 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 11:18:14 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 11:18:14 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 11:18:15 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 11:18:15 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 11:18:15 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 11:18:16 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 11:18:16 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 11:18:17 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 11:18:17 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 11:18:17 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 11:18:17 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 11:18:17 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 11:18:17 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 11:18:17 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 11:18:17 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:18:17 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 11:18:17 [OrderManagerTest] INFO: Test Date: 2025-06-10 01:18:17 UTC
2025-06-10 11:18:17 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:18:17 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:17 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 11:18:17 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:17 [OrderManagerTest] INFO: Current positions: [{'symbol': 'BTCUSDT', 'leverage': '1', 'autoAddMargin': 0, 'avgPrice': '0', 'liqPrice': '', 'riskLimitValue': '2000000', 'takeProfit': '', 'positionValue': '', 'isReduceOnly': False, 'tpslMode': 'Full', 'riskId': 1, 'trailingStop': '0', 'unrealisedPnl': '', 'markPrice': '123580.3', 'adlRankIndicator': 0, 'cumRealisedPnl': '-220.77645197', 'positionMM': '0', 'createdTime': '1746973619032', 'positionIdx': 0, 'positionIM': '0', 'seq': 9476737940, 'updatedTime': '1749517870708', 'side': '', 'bustPrice': '', 'positionBalance': '0', 'leverageSysUpdatedTime': '', 'curRealisedPnl': '0', 'size': '0', 'positionStatus': 'Normal', 'mmrSysUpdatedTime': '', 'stopLoss': '', 'tradeMode': 0, 'sessionAvgPrice': ''}]
2025-06-10 11:18:17 [OrderManagerTest] INFO: Position structure valid: BTCUSDT
2025-06-10 11:18:17 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:18:17 [OrderManagerTest] INFO: Ticker: Last: 123430.2 - 24h Change: 0.024622%
2025-06-10 11:18:17 [OrderManagerTest] INFO: Ticker: Last: 123750.0 - 24h Change: 0.027277%
2025-06-10 11:18:17 [OrderManagerTest] INFO: Ticker: Last: 123580.3 - 24h Change: 0.025868%
2025-06-10 11:18:19 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:19 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 11:18:19 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:19 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:18:19 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:21 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:21 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 11:18:21 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:21 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D6A767FCC0> BTCUSDT (approx $5)
2025-06-10 11:18:21 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 11:18:21 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 11:18:21 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:23 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:23 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 11:18:23 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:23 [OrderManagerTest] INFO: Placing market sell order: <coroutine object OrderManager.calculate_position_size at 0x000001D6A767F6C0> BTCUSDT (approx $5)
2025-06-10 11:18:23 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 11:18:23 [OrderManagerTest] ERROR: Failed to place market sell order
2025-06-10 11:18:23 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:25 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:25 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 11:18:25 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:25 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:18:25 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:27 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:27 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 11:18:27 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:27 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:18:27 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:29 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:29 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 11:18:29 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:29 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D6A767FCC0> BTCUSDT
2025-06-10 11:18:29 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 11:18:29 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 11:18:29 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:31 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:31 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 11:18:31 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:32 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D6A767FBC0> BTCUSDT
2025-06-10 11:18:32 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 11:18:32 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 11:18:32 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:34 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:34 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 11:18:34 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:34 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:18:34 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:36 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:36 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 11:18:36 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:36 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D6A767FCC0> BTCUSDT
2025-06-10 11:18:36 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 11:18:36 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 11:18:36 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:38 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:38 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 11:18:38 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:38 [OrderManagerTest] ERROR: Risk management test failed: could not convert string to float: ''
2025-06-10 11:18:38 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:40 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:40 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 11:18:40 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:40 [OrderManagerTest] INFO: Placing market buy order: <coroutine object OrderManager.calculate_position_size at 0x000001D6A767FCC0> BTCUSDT
2025-06-10 11:18:40 [OrderManagerTest] ERROR: Error placing market order: float() argument must be a string or a number, not 'coroutine'
2025-06-10 11:18:40 [OrderManagerTest] ERROR: Failed to place market buy order
2025-06-10 11:18:40 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:18:41 [OrderManagerTest] INFO: Ticker: Last: 123518.5 - 24h Change: 0.025355%
2025-06-10 11:18:42 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:18:42 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 11:18:42 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:18:42 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 11:18:43 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:18:43).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 11:18:43 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:18:43).\nRequest → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.'}
2025-06-10 11:18:43 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 11:18:43 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:18:43 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 11:18:43 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 11:18:43 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 11:18:43 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 11:18:43 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:18:45 [OrderManagerTest] INFO: 
============================================================
2025-06-10 11:18:45 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 11:18:45 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:18:45 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 11:18:45 [OrderManagerTest] INFO: Passed: 2 ✅
2025-06-10 11:18:45 [OrderManagerTest] INFO: Failed: 11 ❌
2025-06-10 11:18:45 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 11:18:45 [OrderManagerTest] INFO: Success Rate: 15.4%
2025-06-10 11:18:45 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 11:18:45 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 11:18:45 [OrderManagerTest] INFO: ✅ Position Status: PASS
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Market Buy Order: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Market Sell Order: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Risk Management: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ❌ Order Tracking: FAIL
2025-06-10 11:18:45 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 11:18:45 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_111845.json
2025-06-10 11:18:45 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 11:18:45 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 11:18:45 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 11:18:45 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 11:18:45 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 11:18:45 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 11:18:45 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 11:18:45 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 11:18:45 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 11:18:45 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 11:18:45 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 11:18:46 [OrderManagerTest] INFO: DataManager closed
2025-06-10 11:18:46 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 11:18:46 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 11:24:12 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 11:24:12 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 11:24:12 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 11:24:13 [OrderManagerTest] INFO: Server time: 2025-06-10 11:24:13
2025-06-10 11:24:13 [OrderManagerTest] INFO: Local time: 2025-06-10 11:24:13
2025-06-10 11:24:13 [OrderManagerTest] INFO: Time difference: -0.16 seconds
2025-06-10 11:24:13 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 11:25:00
2025-06-10 11:24:13 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 11:25:00
2025-06-10 11:24:13 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 12:00:00
2025-06-10 11:24:13 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 11:24:13 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 11:24:15 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 11:24:15 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 11:24:15 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 11:24:16 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 11:24:16 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 11:24:16 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 11:24:17 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 11:24:17 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 11:24:18 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 11:24:18 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 11:24:18 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 11:24:18 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 11:24:18 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 11:24:18 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 11:24:18 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 11:24:18 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:24:18 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 11:24:18 [OrderManagerTest] INFO: Test Date: 2025-06-10 01:24:18 UTC
2025-06-10 11:24:18 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:24:18 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:18 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 11:24:18 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:18 [OrderManagerTest] ERROR: Position status test failed: object list can't be used in 'await' expression
2025-06-10 11:24:18 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:18 [OrderManagerTest] INFO: Ticker: Last: 123664.8 - 24h Change: 0.016609%
2025-06-10 11:24:20 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:20 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 11:24:20 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:20 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:24:20 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:22 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:22 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 11:24:22 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:23 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123664.8: 0.001
2025-06-10 11:24:23 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT (approx $5)
2025-06-10 11:24:23 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 154db882-ebad-404c-90ba-308802247271
2025-06-10 11:24:23 [OrderManagerTest] INFO: Market buy order placed: 154db882-ebad-404c-90ba-308802247271
2025-06-10 11:24:23 [OrderManagerTest] INFO: Ticker: Last: 123681.4 - 24h Change: 0.016745%
2025-06-10 11:24:26 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 11:24:26 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:24:28 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:28 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 11:24:28 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:29 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123681.4: 0.001
2025-06-10 11:24:29 [OrderManagerTest] INFO: Placing market sell order: 0.001 BTCUSDT (approx $5)
2025-06-10 11:24:29 [OrderManagerTest] INFO: Market Sell order placed for 0.001 BTCUSDT: c8b78e50-b538-4d17-b702-f10c3a425529
2025-06-10 11:24:29 [OrderManagerTest] INFO: Market sell order placed: c8b78e50-b538-4d17-b702-f10c3a425529
2025-06-10 11:24:29 [OrderManagerTest] INFO: Ticker: Last: 123525.0 - 24h Change: 0.015459%
2025-06-10 11:24:32 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 11:24:32 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:24:34 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:34 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 11:24:34 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:34 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:24:34 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:36 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:36 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 11:24:36 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:36 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:24:36 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:38 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:38 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 11:24:38 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:39 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123525.0: 0.001
2025-06-10 11:24:39 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:24:39 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 2e1cf663-d930-4aad-864b-0cabb955f333
2025-06-10 11:24:39 [OrderManagerTest] INFO: Market buy order placed: 2e1cf663-d930-4aad-864b-0cabb955f333
2025-06-10 11:24:39 [OrderManagerTest] INFO: Ticker: Last: 123681.4 - 24h Change: 0.016745%
2025-06-10 11:24:42 [OrderManagerTest] ERROR: Take profit test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:24:42 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:44 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:44 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 11:24:44 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:44 [OrderManagerTest] ERROR: Stop loss test failed: object list can't be used in 'await' expression
2025-06-10 11:24:44 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:46 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:46 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 11:24:46 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:46 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:24:46 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:48 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:48 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 11:24:48 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:49 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123681.4: 0.001
2025-06-10 11:24:49 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:24:49 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 7c5d8e9a-9bee-49e2-984e-e8cd33520c85
2025-06-10 11:24:49 [OrderManagerTest] INFO: Market buy order placed: 7c5d8e9a-9bee-49e2-984e-e8cd33520c85
2025-06-10 11:24:52 [OrderManagerTest] ERROR: Close position test failed: object list can't be used in 'await' expression
2025-06-10 11:24:52 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:54 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:54 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 11:24:54 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:55 [OrderManagerTest] ERROR: Risk management test failed: could not convert string to float: ''
2025-06-10 11:24:55 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:24:57 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:24:57 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 11:24:57 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:24:57 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123681.4: 0.001
2025-06-10 11:24:57 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:24:57 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 1a407c0a-7b03-4e0f-a2bd-1c805143d880
2025-06-10 11:24:57 [OrderManagerTest] INFO: Market buy order placed: 1a407c0a-7b03-4e0f-a2bd-1c805143d880
2025-06-10 11:24:57 [OrderManagerTest] INFO: Ticker: Last: 123689.7 - 24h Change: 0.016813%
2025-06-10 11:25:00 [OrderManagerTest] INFO: Updated 1m candle from REST API: O: 123689.7 H: 123689.7 L: 123689.7 C: 123689.7 V: 0.0
2025-06-10 11:25:00 [OrderManagerTest] INFO: New 1m candle closed: 2025-06-10 01:25:00 - O: 123689.7 H: 123689.7 L: 123689.7 C: 123689.7 V: 0.0
2025-06-10 11:25:00 [OrderManagerTest] INFO: Updated 5m candle from REST API: O: 123689.7 H: 123689.7 L: 123689.7 C: 123689.7 V: 0.0
2025-06-10 11:25:00 [OrderManagerTest] INFO: New 5m candle closed: 2025-06-10 01:25:00 - O: 123689.7 H: 123689.7 L: 123689.7 C: 123689.7 V: 0.0
2025-06-10 11:25:01 [OrderManagerTest] INFO: Active orders: 0
2025-06-10 11:25:01 [OrderManagerTest] INFO: Order history entries: 20
2025-06-10 11:25:01 [OrderManagerTest] INFO: Found order in history: {'symbol': 'BTCUSDT', 'orderType': 'Market', 'orderLinkId': '', 'slLimitPrice': '0', 'orderId': '1a407c0a-7b03-4e0f-a2bd-1c805143d880', 'cancelType': 'UNKNOWN', 'avgPrice': '123689.7', 'stopOrderType': '', 'lastPriceOnCreated': '123681.4', 'orderStatus': 'Filled', 'createType': 'CreateByUser', 'takeProfit': '', 'cumExecValue': '123.6897', 'tpslMode': '', 'smpType': 'None', 'triggerDirection': 0, 'blockTradeId': '', 'rejectReason': 'EC_NoError', 'isLeverage': '', 'price': '124902.3', 'orderIv': '', 'createdTime': '1749518697491', 'tpTriggerBy': '', 'positionIdx': 0, 'timeInForce': 'IOC', 'leavesValue': '0', 'updatedTime': '1749518697495', 'side': 'Buy', 'smpGroup': 0, 'triggerPrice': '', 'tpLimitPrice': '0', 'cumExecFee': '0.04947588', 'slTriggerBy': '', 'leavesQty': '0', 'closeOnTrigger': False, 'slippageToleranceType': 'UNKNOWN', 'placeType': '', 'cumExecQty': '0.001', 'reduceOnly': False, 'qty': '0.001', 'stopLoss': '', 'smpOrderId': '', 'slippageTolerance': '0', 'triggerBy': '', 'extraFees': ''}
2025-06-10 11:25:01 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:25:03 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:25:03 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 11:25:03 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:25:03 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 11:25:03 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:25:03).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 11:25:03 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:25:03).\nRequest → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.'}
2025-06-10 11:25:03 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 11:25:03 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:25:03 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 11:25:03 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 11:25:04 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 11:25:04 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 11:25:04 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:25:06 [OrderManagerTest] INFO: 
============================================================
2025-06-10 11:25:06 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 11:25:06 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:25:06 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 11:25:06 [OrderManagerTest] INFO: Passed: 4 ✅
2025-06-10 11:25:06 [OrderManagerTest] INFO: Failed: 9 ❌
2025-06-10 11:25:06 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 11:25:06 [OrderManagerTest] INFO: Success Rate: 30.8%
2025-06-10 11:25:06 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 11:25:06 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Position Status: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ✅ Market Buy Order: PASS
2025-06-10 11:25:06 [OrderManagerTest] INFO: ✅ Market Sell Order: PASS
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ❌ Risk Management: FAIL
2025-06-10 11:25:06 [OrderManagerTest] INFO: ✅ Order Tracking: PASS
2025-06-10 11:25:06 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 11:25:06 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_112506.json
2025-06-10 11:25:06 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 11:25:06 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 11:25:06 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 11:25:06 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 11:25:06 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 11:25:06 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 11:25:06 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 11:25:06 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 11:25:06 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 11:25:06 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 11:25:06 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 11:25:06 [OrderManagerTest] INFO: DataManager closed
2025-06-10 11:25:06 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 11:25:06 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 11:29:59 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 11:29:59 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 11:29:59 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 11:30:00 [OrderManagerTest] INFO: Server time: 2025-06-10 11:30:00
2025-06-10 11:30:00 [OrderManagerTest] INFO: Local time: 2025-06-10 11:30:00
2025-06-10 11:30:00 [OrderManagerTest] INFO: Time difference: -0.26 seconds
2025-06-10 11:30:00 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 11:31:00
2025-06-10 11:30:00 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 11:35:00
2025-06-10 11:30:00 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 12:00:00
2025-06-10 11:30:00 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 11:30:00 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 11:30:02 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 11:30:02 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 11:30:02 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 11:30:03 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 11:30:03 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 11:30:03 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 11:30:04 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 11:30:04 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 11:30:05 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 11:30:05 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 11:30:05 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 11:30:05 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 11:30:05 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 11:30:05 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 11:30:05 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 11:30:05 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:30:05 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 11:30:05 [OrderManagerTest] INFO: Test Date: 2025-06-10 01:30:05 UTC
2025-06-10 11:30:05 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:30:05 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:05 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 11:30:05 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:05 [OrderManagerTest] ERROR: Position status test failed: object list can't be used in 'await' expression
2025-06-10 11:30:05 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:05 [OrderManagerTest] INFO: Ticker: Last: 123525.0 - 24h Change: 0.018685%
2025-06-10 11:30:07 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:07 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 11:30:07 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:07 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:30:07 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:09 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:09 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 11:30:09 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:10 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123693.9: 0.001
2025-06-10 11:30:10 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT (approx $5)
2025-06-10 11:30:10 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: d6276ae4-c6ac-4c2f-b15c-ae9a3cb8897a
2025-06-10 11:30:10 [OrderManagerTest] INFO: Market buy order placed: d6276ae4-c6ac-4c2f-b15c-ae9a3cb8897a
2025-06-10 11:30:10 [OrderManagerTest] INFO: Ticker: Last: 123693.9 - 24h Change: 0.020078%
2025-06-10 11:30:11 [OrderManagerTest] INFO: Ticker: Last: 123696.0 - 24h Change: 0.020095%
2025-06-10 11:30:11 [OrderManagerTest] INFO: Ticker: Last: 123525.0 - 24h Change: 0.018685%
2025-06-10 11:30:13 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 11:30:13 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:30:15 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:15 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 11:30:15 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:16 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123525.0: 0.001
2025-06-10 11:30:16 [OrderManagerTest] INFO: Placing market sell order: 0.001 BTCUSDT (approx $5)
2025-06-10 11:30:16 [OrderManagerTest] INFO: Market Sell order placed for 0.001 BTCUSDT: d325caf5-b4e1-4563-b418-687f876dd0a8
2025-06-10 11:30:16 [OrderManagerTest] INFO: Market sell order placed: d325caf5-b4e1-4563-b418-687f876dd0a8
2025-06-10 11:30:19 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 11:30:19 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:30:21 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:21 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 11:30:21 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:21 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:30:21 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:23 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:23 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 11:30:23 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:23 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:30:23 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:25 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:25 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 11:30:25 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:26 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123525.0: 0.001
2025-06-10 11:30:26 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:30:26 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 21301e9f-adbd-40be-9353-e83d5169be4e
2025-06-10 11:30:26 [OrderManagerTest] INFO: Market buy order placed: 21301e9f-adbd-40be-9353-e83d5169be4e
2025-06-10 11:30:26 [OrderManagerTest] INFO: Ticker: Last: 123696.0 - 24h Change: 0.020095%
2025-06-10 11:30:29 [OrderManagerTest] ERROR: Take profit test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:30:29 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:31 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:31 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 11:30:31 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:31 [OrderManagerTest] ERROR: Stop loss test failed: object list can't be used in 'await' expression
2025-06-10 11:30:31 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:33 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:33 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 11:30:33 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:33 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 11:30:33 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:34 [OrderManagerTest] INFO: Ticker: Last: 123525.0 - 24h Change: 0.049525%
2025-06-10 11:30:35 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:35 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 11:30:35 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:36 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123525.0: 0.001
2025-06-10 11:30:36 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:30:36 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 5e32d26d-4b36-4c48-be0b-1d92122152e7
2025-06-10 11:30:36 [OrderManagerTest] INFO: Market buy order placed: 5e32d26d-4b36-4c48-be0b-1d92122152e7
2025-06-10 11:30:36 [OrderManagerTest] INFO: Ticker: Last: 123696.0 - 24h Change: 0.050977%
2025-06-10 11:30:39 [OrderManagerTest] ERROR: Close position test failed: object list can't be used in 'await' expression
2025-06-10 11:30:39 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:41 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:41 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 11:30:41 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:41 [OrderManagerTest] ERROR: Risk management test failed: could not convert string to float: ''
2025-06-10 11:30:41 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 11:30:43 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:43 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 11:30:43 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:44 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 123696.0: 0.001
2025-06-10 11:30:44 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 11:30:44 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 5820ff96-8867-4c4b-a8d6-d9a9e1845bc8
2025-06-10 11:30:44 [OrderManagerTest] INFO: Market buy order placed: 5820ff96-8867-4c4b-a8d6-d9a9e1845bc8
2025-06-10 11:30:44 [OrderManagerTest] INFO: Ticker: Last: 123989.0 - 24h Change: 0.053467%
2025-06-10 11:30:48 [OrderManagerTest] INFO: Active orders: 0
2025-06-10 11:30:48 [OrderManagerTest] INFO: Order history entries: 20
2025-06-10 11:30:48 [OrderManagerTest] INFO: Found order in history: {'symbol': 'BTCUSDT', 'orderType': 'Market', 'orderLinkId': '', 'slLimitPrice': '0', 'orderId': '5820ff96-8867-4c4b-a8d6-d9a9e1845bc8', 'cancelType': 'UNKNOWN', 'avgPrice': '123989', 'stopOrderType': '', 'lastPriceOnCreated': '123696', 'orderStatus': 'Filled', 'createType': 'CreateByUser', 'takeProfit': '', 'cumExecValue': '123.989', 'tpslMode': '', 'smpType': 'None', 'triggerDirection': 0, 'blockTradeId': '', 'rejectReason': 'EC_NoError', 'isLeverage': '', 'price': '124823.7', 'orderIv': '', 'createdTime': '1749519044632', 'tpTriggerBy': '', 'positionIdx': 0, 'timeInForce': 'IOC', 'leavesValue': '0', 'updatedTime': '1749519044636', 'side': 'Buy', 'smpGroup': 0, 'triggerPrice': '', 'tpLimitPrice': '0', 'cumExecFee': '0.0495956', 'slTriggerBy': '', 'leavesQty': '0', 'closeOnTrigger': False, 'slippageToleranceType': 'UNKNOWN', 'placeType': '', 'cumExecQty': '0.001', 'reduceOnly': False, 'qty': '0.001', 'stopLoss': '', 'smpOrderId': '', 'slippageTolerance': '0', 'triggerBy': '', 'extraFees': ''}
2025-06-10 11:30:48 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:30:50 [OrderManagerTest] INFO: 
==================================================
2025-06-10 11:30:50 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 11:30:50 [OrderManagerTest] INFO: ==================================================
2025-06-10 11:30:50 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 11:30:50 [OrderManagerTest] ERROR: Error placing market order: params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:30:50).
Request → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.
2025-06-10 11:30:50 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'params error: symbol invalid INVALID (ErrCode: 10001) (ErrTime: 01:30:50).\nRequest → POST https://api-testnet.bybit.com/v5/order/create: {"category": "linear", "symbol": "INVALID", "side": "Buy", "orderType": "Market", "qty": "0.001"}.'}
2025-06-10 11:30:50 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 11:30:50 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 11:30:50 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 11:30:50 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 11:30:50 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 11:30:50 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 11:30:50 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 11:30:52 [OrderManagerTest] INFO: 
============================================================
2025-06-10 11:30:52 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 11:30:52 [OrderManagerTest] INFO: ============================================================
2025-06-10 11:30:52 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 11:30:52 [OrderManagerTest] INFO: Passed: 4 ✅
2025-06-10 11:30:52 [OrderManagerTest] INFO: Failed: 9 ❌
2025-06-10 11:30:52 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 11:30:52 [OrderManagerTest] INFO: Success Rate: 30.8%
2025-06-10 11:30:52 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 11:30:52 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Position Status: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ✅ Market Buy Order: PASS
2025-06-10 11:30:52 [OrderManagerTest] INFO: ✅ Market Sell Order: PASS
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Close Position: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ❌ Risk Management: FAIL
2025-06-10 11:30:52 [OrderManagerTest] INFO: ✅ Order Tracking: PASS
2025-06-10 11:30:52 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 11:30:52 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_113052.json
2025-06-10 11:30:52 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 11:30:53 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 11:30:53 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 11:30:53 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 11:30:53 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 11:30:53 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 11:30:53 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 11:30:53 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 11:30:53 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 11:30:53 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 11:30:53 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 11:30:53 [OrderManagerTest] INFO: DataManager closed
2025-06-10 11:30:53 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 11:30:53 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 12:45:34 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 12:45:34 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 12:45:34 [OrderManagerTest] INFO: Initializing DataManager for BTCUSDT
2025-06-10 12:45:34 [OrderManagerTest] INFO: Server time: 2025-06-10 12:45:34
2025-06-10 12:45:34 [OrderManagerTest] INFO: Local time: 2025-06-10 12:45:34
2025-06-10 12:45:34 [OrderManagerTest] INFO: Time difference: -0.25 seconds
2025-06-10 12:45:34 [OrderManagerTest] INFO: Next 1m candle closes at: 2025-06-10 12:46:00
2025-06-10 12:45:34 [OrderManagerTest] INFO: Next 5m candle closes at: 2025-06-10 12:50:00
2025-06-10 12:45:34 [OrderManagerTest] INFO: Next 1h candle closes at: 2025-06-10 13:00:00
2025-06-10 12:45:34 [OrderManagerTest] INFO: Loading 2000 1m candles for BTCUSDT
2025-06-10 12:45:34 [OrderManagerTest] INFO: Fetching 2 batches of 1m klines
2025-06-10 12:45:36 [OrderManagerTest] INFO: Loaded 2000 1m klines
2025-06-10 12:45:36 [OrderManagerTest] INFO: Loading 1000 5m candles for BTCUSDT
2025-06-10 12:45:36 [OrderManagerTest] INFO: Fetching 1 batches of 5m klines
2025-06-10 12:45:37 [OrderManagerTest] INFO: Loaded 1000 5m klines
2025-06-10 12:45:37 [OrderManagerTest] INFO: Loading 200 1h candles for BTCUSDT
2025-06-10 12:45:37 [OrderManagerTest] INFO: Fetching 1 batches of 1h klines
2025-06-10 12:45:38 [OrderManagerTest] INFO: Loaded 200 1h klines
2025-06-10 12:45:38 [OrderManagerTest] INFO: Connecting to WebSocket at wss://stream-testnet.bybit.com/v5/public/linear
2025-06-10 12:45:38 [OrderManagerTest] INFO: Subscribed to topics: ['kline.1.BTCUSDT', 'kline.5.BTCUSDT', 'kline.60.BTCUSDT', 'tickers.BTCUSDT', 'publicTrade.BTCUSDT']
2025-06-10 12:45:38 [OrderManagerTest] INFO: WebSocket connected successfully
2025-06-10 12:45:38 [OrderManagerTest] INFO: DataManager initialization completed
2025-06-10 12:45:38 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 12:45:38 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 12:45:39 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 12:45:39 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 12:45:39 [OrderManagerTest] INFO: ============================================================
2025-06-10 12:45:39 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 12:45:39 [OrderManagerTest] INFO: Test Date: 2025-06-10 02:45:39 UTC
2025-06-10 12:45:39 [OrderManagerTest] INFO: ============================================================
2025-06-10 12:45:39 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:39 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 12:45:39 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:39 [OrderManagerTest] INFO: Current positions: [{'symbol': 'BTCUSDT', 'leverage': '1', 'autoAddMargin': 0, 'avgPrice': '123740.13333333', 'liqPrice': '', 'riskLimitValue': '2000000', 'takeProfit': '', 'positionValue': '742.4408', 'isReduceOnly': False, 'tpslMode': 'Full', 'riskId': 1, 'trailingStop': '0', 'unrealisedPnl': '-30.85586', 'markPrice': '118597.49', 'adlRankIndicator': 2, 'cumRealisedPnl': '-221.58919549', 'positionMM': '3.712204', 'createdTime': '1746973619032', 'positionIdx': 0, 'positionIM': '742.4408', 'seq': 9476741558, 'updatedTime': '1749519044636', 'side': 'Buy', 'bustPrice': '', 'positionBalance': '0', 'leverageSysUpdatedTime': '', 'curRealisedPnl': '-0.55746096', 'size': '0.006', 'positionStatus': 'Normal', 'mmrSysUpdatedTime': '', 'stopLoss': '', 'tradeMode': 0, 'sessionAvgPrice': ''}]
2025-06-10 12:45:39 [OrderManagerTest] INFO: Position structure valid: BTCUSDT
2025-06-10 12:45:39 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:45:39 [OrderManagerTest] INFO: Ticker: Last: 118913.8 - 24h Change: 0.009245%
2025-06-10 12:45:39 [OrderManagerTest] INFO: Ticker: Last: 118735.6 - 24h Change: 0.007733%
2025-06-10 12:45:41 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:41 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 12:45:41 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:41 [OrderManagerTest] ERROR: Position sizing test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 12:45:41 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 12:45:41 [OrderManagerTest] INFO: Ticker: Last: 118749.0 - 24h Change: 0.007847%
2025-06-10 12:45:43 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:43 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 12:45:43 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:43 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 118749.0: 0.001
2025-06-10 12:45:43 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT (approx $5)
2025-06-10 12:45:43 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: e86ecbdf-1d12-4fb7-be4e-021cee53b58c
2025-06-10 12:45:43 [OrderManagerTest] INFO: Market buy order placed: e86ecbdf-1d12-4fb7-be4e-021cee53b58c
2025-06-10 12:45:44 [OrderManagerTest] INFO: Ticker: Last: 118947.7 - 24h Change: 0.009533%
2025-06-10 12:45:47 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 12:45:47 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:45:49 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:49 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 12:45:49 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:49 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 118765.2: 0.001
2025-06-10 12:45:49 [OrderManagerTest] INFO: Placing market sell order: 0.001 BTCUSDT (approx $5)
2025-06-10 12:45:49 [OrderManagerTest] INFO: Market Sell order placed for 0.001 BTCUSDT: f3c467b2-fc43-4d76-a831-402b04ce42ee
2025-06-10 12:45:49 [OrderManagerTest] INFO: Market sell order placed: f3c467b2-fc43-4d76-a831-402b04ce42ee
2025-06-10 12:45:49 [OrderManagerTest] INFO: Ticker: Last: 118765.2 - 24h Change: 0.007984%
2025-06-10 12:45:53 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 12:45:53 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:45:55 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:55 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 12:45:55 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:55 [OrderManagerTest] ERROR: Limit buy test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 12:45:55 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 12:45:57 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:57 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 12:45:57 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:57 [OrderManagerTest] ERROR: Limit sell test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 12:45:57 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 12:45:59 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:45:59 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 12:45:59 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:45:59 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 118765.2: 0.001
2025-06-10 12:45:59 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 12:46:00 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: a16bc447-2d89-4348-8681-6caee7f74adc
2025-06-10 12:46:00 [OrderManagerTest] INFO: Market buy order placed: a16bc447-2d89-4348-8681-6caee7f74adc
2025-06-10 12:46:00 [OrderManagerTest] INFO: Ticker: Last: 118947.7 - 24h Change: 0.009533%
2025-06-10 12:46:00 [OrderManagerTest] INFO: Updated 1m candle from REST API: O: 118765.2 H: 118765.2 L: 118765.2 C: 118765.2 V: 0.0
2025-06-10 12:46:00 [OrderManagerTest] INFO: New 1m candle closed: 2025-06-10 02:46:00 - O: 118765.2 H: 118765.2 L: 118765.2 C: 118765.2 V: 0.0
2025-06-10 12:46:03 [OrderManagerTest] ERROR: Take profit test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 12:46:03 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 12:46:05 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:46:05 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 12:46:05 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:46:05 [OrderManagerTest] INFO: Using existing position: [{'symbol': 'BTCUSDT', 'leverage': '1', 'autoAddMargin': 0, 'avgPrice': '122468.67142857', 'liqPrice': '', 'riskLimitValue': '2000000', 'takeProfit': '', 'positionValue': '857.2807', 'isReduceOnly': False, 'tpslMode': 'Full', 'riskId': 1, 'trailingStop': '0', 'unrealisedPnl': '-26.38581', 'markPrice': '118699.27', 'adlRankIndicator': 2, 'cumRealisedPnl': '-226.02215973', 'positionMM': '4.2864035', 'createdTime': '1746973619032', 'positionIdx': 0, 'positionIM': '857.2807', 'seq': 9476786109, 'updatedTime': '1749523560128', 'side': 'Buy', 'bustPrice': '', 'positionBalance': '0', 'leverageSysUpdatedTime': '', 'curRealisedPnl': '-4.9904252', 'size': '0.007', 'positionStatus': 'Normal', 'mmrSysUpdatedTime': '', 'stopLoss': '', 'tradeMode': 0, 'sessionAvgPrice': ''}]
2025-06-10 12:46:05 [OrderManagerTest] ERROR: Stop loss test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 12:46:05 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 12:46:07 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:46:07 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 12:46:07 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:46:07 [OrderManagerTest] ERROR: Cancel order test failed: get_latest_price() takes 1 positional argument but 2 were given
2025-06-10 12:46:07 [OrderManagerTest] INFO: Result: ❌ FAIL
2025-06-10 12:46:09 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:46:09 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 12:46:09 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:46:09 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 118947.7: 0.001
2025-06-10 12:46:09 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 12:46:10 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 018b1ad8-54b3-4416-bd41-5e1a362cad0a
2025-06-10 12:46:10 [OrderManagerTest] INFO: Market buy order placed: 018b1ad8-54b3-4416-bd41-5e1a362cad0a
2025-06-10 12:46:10 [OrderManagerTest] INFO: Ticker: Last: 118943.7 - 24h Change: 0.009499%
2025-06-10 12:46:13 [OrderManagerTest] INFO: Current position size: 0.008
2025-06-10 12:46:13 [OrderManagerTest] INFO: Position closed for BTCUSDT: Buy 0.008 with Sell order
2025-06-10 12:46:13 [OrderManagerTest] INFO: Close position order placed: 36fd5e41-9b37-422c-89f4-a0cecbcedcfe
2025-06-10 12:46:13 [OrderManagerTest] INFO: Ticker: Last: 118773.3 - 24h Change: 0.008053%
2025-06-10 12:46:17 [OrderManagerTest] INFO: Position size after closing: 0.0
2025-06-10 12:46:17 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:46:19 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:46:19 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 12:46:19 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:46:19 [OrderManagerTest] INFO: Account balance: 0.0 USDT
2025-06-10 12:46:19 [OrderManagerTest] INFO: Position size for 0.0 USDT of BTCUSDT at 118860.7: 0.001
2025-06-10 12:46:19 [OrderManagerTest] INFO: Risk 1.0%: 0.0 USDT = 0.001 contracts
2025-06-10 12:46:19 [OrderManagerTest] INFO: Position size for 0.0 USDT of BTCUSDT at 118860.7: 0.001
2025-06-10 12:46:19 [OrderManagerTest] INFO: Risk 2.0%: 0.0 USDT = 0.001 contracts
2025-06-10 12:46:20 [OrderManagerTest] INFO: Position size for 0.0 USDT of BTCUSDT at 118860.7: 0.001
2025-06-10 12:46:20 [OrderManagerTest] INFO: Risk 5.0%: 0.0 USDT = 0.001 contracts
2025-06-10 12:46:20 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:46:20 [OrderManagerTest] INFO: Ticker: Last: 118860.7 - 24h Change: 0.012404%
2025-06-10 12:46:22 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:46:22 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 12:46:22 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:46:22 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 118860.7: 0.001
2025-06-10 12:46:22 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 12:46:22 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 380d7491-a236-4bfb-b327-c52a8d671761
2025-06-10 12:46:22 [OrderManagerTest] INFO: Market buy order placed: 380d7491-a236-4bfb-b327-c52a8d671761
2025-06-10 12:46:22 [OrderManagerTest] INFO: Ticker: Last: 118966.1 - 24h Change: 0.013302%
2025-06-10 12:46:25 [OrderManagerTest] INFO: Active orders: 0
2025-06-10 12:46:26 [OrderManagerTest] INFO: Order history entries: 20
2025-06-10 12:46:26 [OrderManagerTest] INFO: Found order in history: {'symbol': 'BTCUSDT', 'orderType': 'Market', 'orderLinkId': '', 'slLimitPrice': '0', 'orderId': '380d7491-a236-4bfb-b327-c52a8d671761', 'cancelType': 'UNKNOWN', 'avgPrice': '118966.1', 'stopOrderType': '', 'lastPriceOnCreated': '118860.7', 'orderStatus': 'Filled', 'createType': 'CreateByUser', 'takeProfit': '', 'cumExecValue': '118.9661', 'tpslMode': '', 'smpType': 'None', 'triggerDirection': 0, 'blockTradeId': '', 'rejectReason': 'EC_NoError', 'isLeverage': '', 'price': '119909.8', 'orderIv': '', 'createdTime': '1749523582540', 'tpTriggerBy': '', 'positionIdx': 0, 'timeInForce': 'IOC', 'leavesValue': '0', 'updatedTime': '1749523582545', 'side': 'Buy', 'smpGroup': 0, 'triggerPrice': '', 'tpLimitPrice': '0', 'cumExecFee': '0.04758644', 'slTriggerBy': '', 'leavesQty': '0', 'closeOnTrigger': False, 'slippageToleranceType': 'UNKNOWN', 'placeType': '', 'cumExecQty': '0.001', 'reduceOnly': False, 'qty': '0.001', 'stopLoss': '', 'smpOrderId': '', 'slippageTolerance': '0', 'triggerBy': '', 'extraFees': ''}
2025-06-10 12:46:26 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:46:28 [OrderManagerTest] INFO: 
==================================================
2025-06-10 12:46:28 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 12:46:28 [OrderManagerTest] INFO: ==================================================
2025-06-10 12:46:28 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 12:46:28 [OrderManagerTest] ERROR: Unexpected error: API Error 10001: params error: symbol invalid INVALID
2025-06-10 12:46:28 [OrderManagerTest] ERROR: Error placing market order: Unexpected error: API Error 10001: params error: symbol invalid INVALID
2025-06-10 12:46:28 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'Unexpected error: API Error 10001: params error: symbol invalid INVALID'}
2025-06-10 12:46:28 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 12:46:28 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 12:46:28 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 12:46:28 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 12:46:29 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 12:46:29 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 12:46:29 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: 
============================================================
2025-06-10 12:46:31 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 12:46:31 [OrderManagerTest] INFO: ============================================================
2025-06-10 12:46:31 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 12:46:31 [OrderManagerTest] INFO: Passed: 7 ✅
2025-06-10 12:46:31 [OrderManagerTest] INFO: Failed: 6 ❌
2025-06-10 12:46:31 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 12:46:31 [OrderManagerTest] INFO: Success Rate: 53.8%
2025-06-10 12:46:31 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 12:46:31 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Position Status: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: ❌ Position Sizing: FAIL
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Market Buy Order: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Market Sell Order: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: ❌ Limit Buy Order: FAIL
2025-06-10 12:46:31 [OrderManagerTest] INFO: ❌ Limit Sell Order: FAIL
2025-06-10 12:46:31 [OrderManagerTest] INFO: ❌ Take Profit Order: FAIL
2025-06-10 12:46:31 [OrderManagerTest] INFO: ❌ Stop Loss Order: FAIL
2025-06-10 12:46:31 [OrderManagerTest] INFO: ❌ Cancel Orders: FAIL
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Close Position: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Risk Management: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Order Tracking: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 12:46:31 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_124631.json
2025-06-10 12:46:31 [OrderManagerTest] INFO: 
❌ Multiple test failures. OrderManager needs fixes before use.
2025-06-10 12:46:31 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 12:46:31 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 12:46:31 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 12:46:31 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 12:46:31 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 12:46:31 [OrderManagerTest] INFO: Closing DataManager connections
2025-06-10 12:46:31 [OrderManagerTest] INFO: Candle timer cancelled
2025-06-10 12:46:31 [OrderManagerTest] INFO: WebSocket connection closed
2025-06-10 12:46:31 [OrderManagerTest] WARNING: WebSocket connection closed
2025-06-10 12:46:31 [OrderManagerTest] INFO: Skipping WebSocket reconnection during shutdown
2025-06-10 12:46:31 [OrderManagerTest] INFO: DataManager closed
2025-06-10 12:46:31 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 12:46:31 [OrderManagerTest] INFO: Shutdown complete
2025-06-10 22:28:51 [OrderManagerTest] INFO: Initializing OrderManager test environment
2025-06-10 22:28:51 [OrderManagerTest] INFO: Using API key: pfL5a...49rIy (testnet=True)
2025-06-10 22:28:51 [OrderManagerTest] INFO: DataManager initialized
2025-06-10 22:28:51 [OrderManagerTest] INFO: DataManager starting...
2025-06-10 22:28:52 [OrderManagerTest] INFO: Initial ticker loaded for BTCUSDT
2025-06-10 22:28:52 [OrderManagerTest] INFO: DataManager initialized successfully
2025-06-10 22:28:52 [OrderManagerTest] INFO: OrderManager initialized
2025-06-10 22:28:52 [OrderManagerTest] INFO: OrderManager starting...
2025-06-10 22:28:52 [OrderManagerTest] INFO: OrderManager initialized successfully
2025-06-10 22:28:52 [OrderManagerTest] INFO: Test environment initialized successfully
2025-06-10 22:28:52 [OrderManagerTest] INFO: ============================================================
2025-06-10 22:28:52 [OrderManagerTest] INFO: STARTING ORDER MANAGER TESTING
2025-06-10 22:28:52 [OrderManagerTest] INFO: Test Date: 2025-06-10 12:28:52 UTC
2025-06-10 22:28:52 [OrderManagerTest] INFO: ============================================================
2025-06-10 22:28:52 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:28:52 [OrderManagerTest] INFO: TESTING: Position Status
2025-06-10 22:28:52 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:28:53 [OrderManagerTest] INFO: Current positions: [{'symbol': 'BTCUSDT', 'leverage': '1', 'autoAddMargin': 0, 'avgPrice': '118966.1', 'liqPrice': '', 'riskLimitValue': '2000000', 'takeProfit': '', 'positionValue': '118.9661', 'isReduceOnly': False, 'tpslMode': 'Full', 'riskId': 1, 'trailingStop': '0', 'unrealisedPnl': '-20.32909', 'markPrice': '98637.01', 'adlRankIndicator': 2, 'cumRealisedPnl': '-253.03408601', 'positionMM': '0.5948305', 'createdTime': '1746973619032', 'positionIdx': 0, 'positionIM': '118.9661', 'seq': 9476881036, 'updatedTime': '1749542400012', 'side': 'Buy', 'bustPrice': '', 'positionBalance': '0', 'leverageSysUpdatedTime': '', 'curRealisedPnl': '-0.54627424', 'size': '0.001', 'positionStatus': 'Normal', 'mmrSysUpdatedTime': '', 'stopLoss': '', 'tradeMode': 0, 'sessionAvgPrice': ''}]
2025-06-10 22:28:53 [OrderManagerTest] INFO: Position structure valid: BTCUSDT
2025-06-10 22:28:53 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:28:55 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:28:55 [OrderManagerTest] INFO: TESTING: Position Sizing
2025-06-10 22:28:55 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:28:55 [OrderManagerTest] INFO: Current BTCUSDT price: 97628.4
2025-06-10 22:28:55 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97628.4: 0.001
2025-06-10 22:28:55 [OrderManagerTest] INFO: USDT 5: 0.001 contracts ($97.63)
2025-06-10 22:28:55 [OrderManagerTest] INFO: Position size for 10 USDT of BTCUSDT at 97628.4: 0.001
2025-06-10 22:28:55 [OrderManagerTest] INFO: USDT 10: 0.001 contracts ($97.63)
2025-06-10 22:28:56 [OrderManagerTest] INFO: Position size for 50 USDT of BTCUSDT at 97628.4: 0.001
2025-06-10 22:28:56 [OrderManagerTest] INFO: USDT 50: 0.001 contracts ($97.63)
2025-06-10 22:28:56 [OrderManagerTest] INFO: Position size for 100 USDT of BTCUSDT at 97628.4: 0.001
2025-06-10 22:28:56 [OrderManagerTest] INFO: USDT 100: 0.001 contracts ($97.63)
2025-06-10 22:28:56 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:28:58 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:28:58 [OrderManagerTest] INFO: TESTING: Market Buy Order
2025-06-10 22:28:58 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:28:58 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97589.8: 0.001
2025-06-10 22:28:58 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT (approx $5)
2025-06-10 22:28:59 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 1c3fde76-d5c2-4241-b6e0-77ac0a825004
2025-06-10 22:28:59 [OrderManagerTest] INFO: Market buy order placed: 1c3fde76-d5c2-4241-b6e0-77ac0a825004
2025-06-10 22:29:02 [OrderManagerTest] INFO: Order status: Filled
2025-06-10 22:29:02 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:04 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:04 [OrderManagerTest] INFO: TESTING: Market Sell Order
2025-06-10 22:29:04 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:05 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97500.0: 0.001
2025-06-10 22:29:05 [OrderManagerTest] INFO: Placing market sell order: 0.001 BTCUSDT (approx $5)
2025-06-10 22:29:05 [OrderManagerTest] INFO: Market Sell order placed for 0.001 BTCUSDT: 5fec55ac-c650-4a2c-b41c-c84f9fec044f
2025-06-10 22:29:05 [OrderManagerTest] INFO: Market sell order placed: 5fec55ac-c650-4a2c-b41c-c84f9fec044f
2025-06-10 22:29:09 [OrderManagerTest] INFO: Order status: Cancelled
2025-06-10 22:29:09 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:11 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:11 [OrderManagerTest] INFO: TESTING: Limit Buy Order
2025-06-10 22:29:11 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:11 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97425.8: 0.001
2025-06-10 22:29:11 [OrderManagerTest] INFO: Placing limit buy order: 0.001 BTCUSDT @ 96451.54
2025-06-10 22:29:11 [OrderManagerTest] INFO: Limit Buy order placed for 0.001 BTCUSDT @ 96451.54: 7f37eb0e-b737-4ba4-b4ea-75a61f6bafe5
2025-06-10 22:29:11 [OrderManagerTest] INFO: Limit buy order placed: 7f37eb0e-b737-4ba4-b4ea-75a61f6bafe5
2025-06-10 22:29:14 [OrderManagerTest] INFO: Order status: New
2025-06-10 22:29:14 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:16 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:16 [OrderManagerTest] INFO: TESTING: Limit Sell Order
2025-06-10 22:29:16 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:16 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97376.4: 0.001
2025-06-10 22:29:16 [OrderManagerTest] INFO: Placing limit sell order: 0.001 BTCUSDT @ 98350.16
2025-06-10 22:29:16 [OrderManagerTest] INFO: Limit Sell order placed for 0.001 BTCUSDT @ 98350.16: 6e24308b-b004-4bb0-9d6d-a6f9bf282845
2025-06-10 22:29:16 [OrderManagerTest] INFO: Limit sell order placed: 6e24308b-b004-4bb0-9d6d-a6f9bf282845
2025-06-10 22:29:19 [OrderManagerTest] INFO: Order status: New
2025-06-10 22:29:19 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:21 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:21 [OrderManagerTest] INFO: TESTING: Take Profit Order
2025-06-10 22:29:21 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:21 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97331.1: 0.001
2025-06-10 22:29:21 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 22:29:21 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 6e83d247-dc39-4415-87f5-543b03a495c4
2025-06-10 22:29:21 [OrderManagerTest] INFO: Market buy order placed: 6e83d247-dc39-4415-87f5-543b03a495c4
2025-06-10 22:29:25 [OrderManagerTest] INFO: Setting take profit at 99485.0
2025-06-10 22:29:25 [OrderManagerTest] INFO: Take profit set at 99485.0 for Buy position of BTCUSDT
2025-06-10 22:29:25 [OrderManagerTest] INFO: Take profit order placed: tp_BTCUSDT_99485
2025-06-10 22:29:28 [OrderManagerTest] WARNING: Order tp_BTCUSDT_99485 not found for BTCUSDT
2025-06-10 22:29:28 [OrderManagerTest] INFO: Take profit status: Not Found
2025-06-10 22:29:28 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:30 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:30 [OrderManagerTest] INFO: TESTING: Stop Loss Order
2025-06-10 22:29:30 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:30 [OrderManagerTest] INFO: Using existing position: [{'symbol': 'BTCUSDT', 'leverage': '1', 'autoAddMargin': 0, 'avgPrice': '104722.06666667', 'liqPrice': '', 'riskLimitValue': '2000000', 'takeProfit': '99485', 'positionValue': '209.44413334', 'isReduceOnly': False, 'tpslMode': 'Full', 'riskId': 1, 'trailingStop': '0', 'unrealisedPnl': '-13.00221334', 'markPrice': '98220.96', 'adlRankIndicator': 2, 'cumRealisedPnl': '-259.50173575', 'positionMM': '1.04722067', 'createdTime': '1746973619032', 'positionIdx': 0, 'positionIM': '209.44413334', 'seq': 9476989549, 'updatedTime': '1749558565782', 'side': 'Buy', 'bustPrice': '', 'positionBalance': '0', 'leverageSysUpdatedTime': '', 'curRealisedPnl': '-7.01392398', 'size': '0.002', 'positionStatus': 'Normal', 'mmrSysUpdatedTime': '', 'stopLoss': '', 'tradeMode': 0, 'sessionAvgPrice': ''}]
2025-06-10 22:29:30 [OrderManagerTest] INFO: Setting stop loss at 96314.82
2025-06-10 22:29:31 [OrderManagerTest] INFO: Stop loss set at 96314.82 for Buy position of BTCUSDT
2025-06-10 22:29:31 [OrderManagerTest] INFO: Stop loss order placed: sl_BTCUSDT_96314
2025-06-10 22:29:33 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:35 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:35 [OrderManagerTest] INFO: TESTING: Cancel Orders
2025-06-10 22:29:35 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:35 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97249.8: 0.001
2025-06-10 22:29:35 [OrderManagerTest] INFO: Placing limit buy order to cancel: 0.001 BTCUSDT @ 94332.31
2025-06-10 22:29:35 [OrderManagerTest] INFO: Limit Buy order placed for 0.001 BTCUSDT @ 94332.31: eed1f511-964e-4d07-873c-0c3af78e244d
2025-06-10 22:29:35 [OrderManagerTest] INFO: Limit buy order placed: eed1f511-964e-4d07-873c-0c3af78e244d
2025-06-10 22:29:37 [OrderManagerTest] INFO: Order status before cancellation: New
2025-06-10 22:29:38 [OrderManagerTest] INFO: Order eed1f511-964e-4d07-873c-0c3af78e244d for BTCUSDT cancelled
2025-06-10 22:29:38 [OrderManagerTest] INFO: Cancel result: {'orderId': 'eed1f511-964e-4d07-873c-0c3af78e244d', 'orderLinkId': ''}
2025-06-10 22:29:41 [OrderManagerTest] INFO: Order status after cancellation: Cancelled
2025-06-10 22:29:41 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:43 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:43 [OrderManagerTest] INFO: TESTING: Close Position
2025-06-10 22:29:43 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:43 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 97128.0: 0.001
2025-06-10 22:29:43 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 22:29:44 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: b167113b-e53c-43a8-8cc8-dfe5067fff65
2025-06-10 22:29:44 [OrderManagerTest] INFO: Market buy order placed: b167113b-e53c-43a8-8cc8-dfe5067fff65
2025-06-10 22:29:47 [OrderManagerTest] INFO: Current position size: 0.003
2025-06-10 22:29:47 [OrderManagerTest] INFO: Position closed for BTCUSDT: Buy 0.003 with Sell order
2025-06-10 22:29:47 [OrderManagerTest] INFO: Close position order placed: 65c913f0-3135-4c21-87d8-afea57934012
2025-06-10 22:29:51 [OrderManagerTest] INFO: Position size after closing: 0.003
2025-06-10 22:29:51 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:53 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:53 [OrderManagerTest] INFO: TESTING: Risk Management
2025-06-10 22:29:53 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:53 [OrderManagerTest] INFO: Account balance: 0.0 USDT
2025-06-10 22:29:53 [OrderManagerTest] INFO: Position size for 0.0 USDT of BTCUSDT at 97038.5: 0.001
2025-06-10 22:29:53 [OrderManagerTest] INFO: Risk 1.0%: 0.0 USDT = 0.001 contracts
2025-06-10 22:29:54 [OrderManagerTest] INFO: Position size for 0.0 USDT of BTCUSDT at 97038.5: 0.001
2025-06-10 22:29:54 [OrderManagerTest] INFO: Risk 2.0%: 0.0 USDT = 0.001 contracts
2025-06-10 22:29:54 [OrderManagerTest] INFO: Position size for 0.0 USDT of BTCUSDT at 96991.0: 0.001
2025-06-10 22:29:54 [OrderManagerTest] INFO: Risk 5.0%: 0.0 USDT = 0.001 contracts
2025-06-10 22:29:54 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:29:56 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:29:56 [OrderManagerTest] INFO: TESTING: Order Tracking
2025-06-10 22:29:56 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:29:56 [OrderManagerTest] INFO: Position size for 5 USDT of BTCUSDT at 96991.0: 0.001
2025-06-10 22:29:56 [OrderManagerTest] INFO: Placing market buy order: 0.001 BTCUSDT
2025-06-10 22:29:57 [OrderManagerTest] INFO: Market Buy order placed for 0.001 BTCUSDT: 614d4e15-9ee5-4549-b91d-5781796eb09b
2025-06-10 22:29:57 [OrderManagerTest] INFO: Market buy order placed: 614d4e15-9ee5-4549-b91d-5781796eb09b
2025-06-10 22:30:00 [OrderManagerTest] INFO: Active orders: 3
2025-06-10 22:30:00 [OrderManagerTest] INFO: Order history entries: 20
2025-06-10 22:30:00 [OrderManagerTest] INFO: Found order in history: {'symbol': 'BTCUSDT', 'orderType': 'Market', 'orderLinkId': '', 'slLimitPrice': '0', 'orderId': '614d4e15-9ee5-4549-b91d-5781796eb09b', 'cancelType': 'UNKNOWN', 'avgPrice': '97200', 'stopOrderType': '', 'lastPriceOnCreated': '96991', 'orderStatus': 'Filled', 'createType': 'CreateByUser', 'takeProfit': '', 'cumExecValue': '97.2', 'tpslMode': '', 'smpType': 'None', 'triggerDirection': 0, 'blockTradeId': '', 'rejectReason': 'EC_NoError', 'isLeverage': '', 'price': '99885.6', 'orderIv': '', 'createdTime': '1749558596947', 'tpTriggerBy': '', 'positionIdx': 0, 'timeInForce': 'IOC', 'leavesValue': '0', 'updatedTime': '1749558596951', 'side': 'Buy', 'smpGroup': 0, 'triggerPrice': '', 'tpLimitPrice': '0', 'cumExecFee': '0.03888', 'slTriggerBy': '', 'leavesQty': '0', 'closeOnTrigger': False, 'slippageToleranceType': 'UNKNOWN', 'placeType': '', 'cumExecQty': '0.001', 'reduceOnly': False, 'qty': '0.001', 'stopLoss': '', 'smpOrderId': '', 'slippageTolerance': '0', 'triggerBy': '', 'extraFees': ''}
2025-06-10 22:30:00 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:30:02 [OrderManagerTest] INFO: 
==================================================
2025-06-10 22:30:02 [OrderManagerTest] INFO: TESTING: Error Handling
2025-06-10 22:30:02 [OrderManagerTest] INFO: ==================================================
2025-06-10 22:30:02 [OrderManagerTest] INFO: Testing invalid symbol handling
2025-06-10 22:30:03 [OrderManagerTest] ERROR: Unexpected error: API Error 10001: params error: symbol invalid INVALID
2025-06-10 22:30:03 [OrderManagerTest] ERROR: Error placing market order: Unexpected error: API Error 10001: params error: symbol invalid INVALID
2025-06-10 22:30:03 [OrderManagerTest] INFO: Invalid symbol result: {'error': 'Unexpected error: API Error 10001: params error: symbol invalid INVALID'}
2025-06-10 22:30:03 [OrderManagerTest] INFO: Testing invalid quantity handling
2025-06-10 22:30:03 [OrderManagerTest] ERROR: Invalid quantity: 0
2025-06-10 22:30:03 [OrderManagerTest] INFO: Invalid quantity result: {'error': 'Invalid quantity'}
2025-06-10 22:30:03 [OrderManagerTest] INFO: Testing invalid order ID handling
2025-06-10 22:30:03 [OrderManagerTest] WARNING: Order invalid_id not found for BTCUSDT
2025-06-10 22:30:03 [OrderManagerTest] INFO: Invalid order ID result: Not Found
2025-06-10 22:30:03 [OrderManagerTest] INFO: Result: ✅ PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: 
============================================================
2025-06-10 22:30:05 [OrderManagerTest] INFO: ORDER MANAGER TEST REPORT
2025-06-10 22:30:05 [OrderManagerTest] INFO: ============================================================
2025-06-10 22:30:05 [OrderManagerTest] INFO: Total Tests: 13
2025-06-10 22:30:05 [OrderManagerTest] INFO: Passed: 13 ✅
2025-06-10 22:30:05 [OrderManagerTest] INFO: Failed: 0 ❌
2025-06-10 22:30:05 [OrderManagerTest] INFO: Errors: 0 ⚠️
2025-06-10 22:30:05 [OrderManagerTest] INFO: Success Rate: 100.0%
2025-06-10 22:30:05 [OrderManagerTest] INFO: 
Detailed Results:
2025-06-10 22:30:05 [OrderManagerTest] INFO: ------------------------------------------------------------
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Position Status: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Position Sizing: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Market Buy Order: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Market Sell Order: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Limit Buy Order: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Limit Sell Order: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Take Profit Order: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Stop Loss Order: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Cancel Orders: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Close Position: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Risk Management: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Order Tracking: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: ✅ Error Handling: PASS
2025-06-10 22:30:05 [OrderManagerTest] INFO: 
Detailed report saved to: order_manager_test_report_20250610_223005.json
2025-06-10 22:30:05 [OrderManagerTest] INFO: 
🎉 ALL TESTS PASSED! OrderManager is functioning correctly.
2025-06-10 22:30:05 [OrderManagerTest] INFO: Shutting down test environment...
2025-06-10 22:30:05 [OrderManagerTest] INFO: Closing OrderManager...
2025-06-10 22:30:05 [OrderManagerTest] INFO: OrderManager shutting down...
2025-06-10 22:30:05 [OrderManagerTest] INFO: OrderManager closed
2025-06-10 22:30:05 [OrderManagerTest] INFO: Closing DataManager...
2025-06-10 22:30:05 [OrderManagerTest] INFO: DataManager shutting down...
2025-06-10 22:30:05 [OrderManagerTest] INFO: Data update loop cancelled
2025-06-10 22:30:05 [OrderManagerTest] INFO: DataManager shutdown complete
2025-06-10 22:30:06 [OrderManagerTest] INFO: DataManager closed
2025-06-10 22:30:06 [OrderManagerTest] INFO: Cancelling any remaining tasks...
2025-06-10 22:30:06 [OrderManagerTest] INFO: Shutdown complete
